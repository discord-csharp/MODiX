@using Modix.Web.Models;
@using Modix.Web.Models.Common;
@using Modix.Web.Models.UserLookup;
@using Modix.Web.Services;
@using MudBlazor

<MudText Typo="Typo.h5">@Title</MudText>
<MudAutocomplete T="ChannelInformation"
                    Placeholder="@("#general")"
                    AdornmentIcon="@Icons.Material.Filled.Search"
                    SearchFunc="Search"
                    MinCharacters="3"
                    Immediate="false"
                    ResetValueOnEmptyText="true"
                    ValueChanged="SelectedChannelChanged"
                    ToStringFunc="channel => channel?.Name"
                    Clearable="true"
                    Adornment="Adornment.Start"
                    SelectValueOnTab="true">
</MudAutocomplete>


@code {
    [Inject]
    public DiscordUserService DiscordUserService { get; set; } = null!;

    [Parameter]
    public EventCallback<ChannelInformation> SelectedChannelChanged { get; set; }

    [Parameter]
    public string? Title { get; set; } = "Channel Name";

    private Task<IEnumerable<ChannelInformation>> Search(string query)
    {
        return Task.FromResult(DiscordUserService.AutocompleteChannels(query));
    }
}
