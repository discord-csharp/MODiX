@page "/logs/{SubPage}"
@page "/logs"
@attribute [Authorize(Policy = nameof(AuthorizationClaim.ModerationRead))]
@using Modix.Data.Models.Core;
@using Modix.Web.Components
@using MudBlazor

<PageTitle>Modix - Logs</PageTitle>

<CascadingAuthenticationState>

    <MudGrid>
        <MudItem xs="2">
            <MudText Typo="Typo.h6">Logs</MudText>
            <MudPaper>
                <MudList SelectedValue="@SubPage" Clickable="true">
                    <MudListItem Value="@("deletedMessages")" Href="/logs/deletedMessages" Text="Deletions"/>
                    <MudDivider/>
                    <MudListItem Value="@("infractions")" Href="/logs/infractions" Text="Infractions"/>
                </MudList>
            </MudPaper>
        </MudItem>
        <MudItem xs="9">
            @if(SubPage == "infractions")
            {
                <AuthorizeView Policy="@nameof(AuthorizationClaim.ModerationRead)">
                    <Infractions/>
                </AuthorizeView>
            }
            else if(SubPage == "deletedMessages")
            {
                <AuthorizeView Policy="@nameof(AuthorizationClaim.LogViewDeletedMessages)">
                    <DeletedMessages/>
                </AuthorizeView>
            }
        </MudItem>
    </MudGrid>
</CascadingAuthenticationState>

@code {
    [Parameter]
    public string SubPage { get; set; } = "infractions";
}
